# Security-Onion


Diagram showing the lab topology, with the SIEM1 configured to sniff traffic passing over the RT1-LOCAL router

![image](https://github.com/itzyezz/Security-Onion/assets/105263523/4ac22778-11c0-4ae6-b7c1-0ef082e25421)
<br>
<br>
<br>

To start off this lab we log into our SIEM VM **Security Onion** and from the desktop we log into **Sguil** and select siem-eth1.

![image](https://github.com/itzyezz/Security-Onion/assets/105263523/1650f902-f1a7-4705-a1a1-fe0d2df28917)
<br>
<br>
<br>

1. In Sguil, you can see the alerts generated by sample packet captures. The *ST* field shows a color-coded priority indicator for each alert, with red being the highest priority. The *CNT* field shows the number of packets matching the alert. All the alerts seem to have occurred within a very close time period because of the way the samples are replayed through the sensor. <br> <br>
2. I selected the first alert, with ID **3.19**. Note the event message. **ET** identifies the ruleset that produced the match. Emerging Threats is a widely-used open-source IDS ruleset. **SCAN** is a broad classification of the alert type. <br> <br>
3. The flow is set to source **TCP** traffic from IP ranges designated as internal (using the **$HOME_NET** variable, set in the IDS configuration file) to (->) external IP addresses on port **22**, which is the default port for Secure Shell (SSH). There are additional conditions to check that the SYN and reserved **flags (S,12)** are set and to only match if there are five such packets **(count 5)** within two minutes **(seconds, 120)**.
<br>
<br>

![image](https://github.com/itzyezz/Security-Onion/assets/105263523/bfe04813-1b02-4694-be69-f2d40bd2d3e0)
<br>
<br>
<br>
Note that there is another match for SSH in the **reverse** direction **(3.20)**

![image](https://github.com/itzyezz/Security-Onion/assets/105263523/a4b8dd82-98f4-4fa9-a97e-ca442c792aee)

Also for Nmap scan **(3.27)**.

![image](https://github.com/itzyezz/Security-Onion/assets/105263523/ab3ca414-0d59-4868-986b-0c0c6dc425bb)
<br>
<br>

By right-clicking the value **4** in the *CNT* field for alert **3.27** and selecting View Correlated Events, this shows the individual packets that were identified as a single event.

![image](https://github.com/itzyezz/Security-Onion/assets/105263523/80fabdd4-6e69-4559-a30f-13e113ef11e5)
<br>
<br>
<br>

By right-clicking the value **3.27** in the *Alert ID* field and viewing the menu options You can see that these allow you to "pivot" to view the source data in a tool such as **Wireshark, NetworkMiner, or Bro**. 

![image](https://github.com/itzyezz/Security-Onion/assets/105263523/7120ceb7-2ae8-4bbe-88c9-59ea0bbef72d)
<br>
<br>
<br>

By right-clicking the value in the *Src IP* field and viewing the menu options you can see that these allow you to "pivot" to the information already stored about that value elsewhere in the database (via Kibana lookup) or via a search or CTI provider over the Internet. 

![image](https://github.com/itzyezz/Security-Onion/assets/105263523/11af0e44-dbd6-419c-a6ea-c3b021fd5406)
<br>
<br>
<br>

Now I right-clicked the value in the *ST* field. Selected **Update Event Status > Cat VI: Reconnaissance/Probes/Scans**.

![image](https://github.com/itzyezz/Security-Onion/assets/105263523/5b774b1e-4d9b-4bf0-9c1f-02ea9cbc5e3b)




